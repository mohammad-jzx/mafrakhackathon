from transformers import AutoTokenizer, AutoModelForSequenceClassification, Trainer, TrainingArguments
import torch

# بيانات تدريب موسعة ومتنوعة
examples = [
    # sensor_data
    ("كم الرطوبة؟", "sensor_data"),
    ("ما هي درجة الحرارة الآن؟", "sensor_data"),
    ("كم نسبة الرطوبة في الهواء؟", "sensor_data"),
    ("ما هو مستوى PH في التربة؟", "sensor_data"),
    ("ما هو مستوى EC؟", "sensor_data"),
    ("أعطني قراءات الحساس", "sensor_data"),
    ("هل التربة جافة؟", "sensor_data"),
    ("هل أحتاج ري الأرض اليوم؟", "sensor_data"),
    ("ما هي بيانات المستشعر؟", "sensor_data"),
    ("كم درجة الحرارة اليوم؟", "sensor_data"),
    ("هل الرطوبة منخفضة؟", "sensor_data"),
    ("ما هي رطوبة التربة؟", "sensor_data"),
    ("كم رطوبة التربة الآن؟", "sensor_data"),
    ("ما هو مستوى الرطوبة؟", "sensor_data"),
    ("هل أحتاج ري النبات اليوم؟", "sensor_data"),
    ("كم رطوبة الجو؟", "sensor_data"),
    ("ما هي درجة حرارة الجو؟", "sensor_data"),
    ("هل يوجد جفاف في التربة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة في الدفيئة؟", "sensor_data"),
    ("هل أحتاج تشغيل الري بالتنقيط؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الطماطم؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول البندورة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول البطاطا؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الفول؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول القمح؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول البصل؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الخيار؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الفلفل؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الباذنجان؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الكوسا؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الجزر؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الفراولة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول البطيخ؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الشمام؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول التفاح؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول العنب؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الزيتون؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول البرتقال؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الليمون؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول المشمش؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الخوخ؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الكمثرى؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الرمان؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول التين؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الفستق؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول اللوز؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الجوز؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول البندق؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الكرز؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول التوت؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الفستق الحلبي؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الفستق السوداني؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الحمص؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول العدس؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الفاصولياء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول البازلاء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الكتان؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول السمسم؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الشوفان؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الشعير؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الصفراء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة البيضاء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الحلوة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الرفيعة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة السكرية؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية البيضاء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الحمراء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية السوداء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية البنفسجية؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الزرقاء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الخضراء؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية البرتقالية؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الوردية؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية البنية؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الرمادية؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء الفاتحة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء الداكنة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المتوسطة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المخضرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المحمرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المزرقّة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المصفرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المبيضة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسودة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة الداكنة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة الفاتحة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المتوسطة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المخضرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المحمرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المزرقّة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المصفرة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المبيضة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المسودة؟", "sensor_data"),
    ("ما هو مستوى الرطوبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة؟", "sensor_data"),
    # crop_info
    ("متى موعد زراعة البطاطا؟", "crop_info"),
    ("ما نوع السماد المناسب للقمح؟", "crop_info"),
    ("ما هي التوصيات لمحصول الطماطم؟", "crop_info"),
    ("ما هي التوصيات لمحصول البندورة؟", "crop_info"),
    ("كيف أزيد إنتاجية القمح؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة؟", "crop_info"),
    ("ما هي الأمراض الشائعة لمحصول البصل؟", "crop_info"),
    ("كيف أعالج اصفرار أوراق النبات؟", "crop_info"),
    ("ما هو نوع التربة المناسب للفول؟", "crop_info"),
    ("ما هي كمية المياه المناسبة لمحصول البطاطا؟", "crop_info"),
    ("ما هو أفضل سماد للطماطم؟", "crop_info"),
    ("ما هو أفضل سماد للبندورة؟", "crop_info"),
    ("متى أزرع القمح؟", "crop_info"),
    ("ما هي طرق مكافحة الآفات في الذرة؟", "crop_info"),
    ("ما هو موعد حصاد البطاطا؟", "crop_info"),
    ("كيف أزيد إنتاجية الطماطم؟", "crop_info"),
    ("كيف أزيد إنتاجية البندورة؟", "crop_info"),
    ("ما هي التوصيات الزراعية لمحصول القمح؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة البندورة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الطماطم؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة البطاطا؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الفول؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة البصل؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الخيار؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الفلفل؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الباذنجان؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الكوسا؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الجزر؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الفراولة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة البطيخ؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الشمام؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة التفاح؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة العنب؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الزيتون؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة البرتقال؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الليمون؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة المشمش؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الخوخ؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الكمثرى؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الرمان؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة التين؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الفستق؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة اللوز؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الجوز؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة البندق؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الكرز؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة التوت؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الفستق الحلبي؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الفستق السوداني؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الحمص؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة العدس؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الفاصولياء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة البازلاء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الكتان؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة السمسم؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الشوفان؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الشعير؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الصفراء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة البيضاء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الحلوة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الرفيعة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة السكرية؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية البيضاء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الحمراء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية السوداء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية البنفسجية؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الزرقاء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الخضراء؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية البرتقالية؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الوردية؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية البنية؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الرمادية؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء الفاتحة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء الداكنة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المتوسطة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المخضرة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المحمرة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المزرقّة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المصفرة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المبيضة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسودة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة الداكنة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة الفاتحة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المتوسطة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المخضرة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المحمرة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المزرقّة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المصفرة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المبيضة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المسودة؟", "crop_info"),
    ("ما هو أفضل وقت لزراعة الذرة الشامية الصفراء المسكرة المسكرة؟", "crop_info"),
    # combined
    ("هل رطوبة التربة مناسبة لمحصول البصل؟", "combined"),
    ("هل أحتاج ري الطماطم اليوم بناءً على الرطوبة؟", "combined"),
    ("هل أحتاج ري البندورة اليوم بناءً على الرطوبة؟", "combined"),
    ("هل درجة الحرارة مناسبة لزراعة البطاطا؟", "combined"),
    ("هل الظروف الجوية مناسبة لزراعة القمح؟", "combined"),
    ("هل أحتاج إضافة سماد للذرة حسب بيانات الحساس؟", "combined"),
    ("هل مستوى PH مناسب لمحصول الطماطم؟", "combined"),
    ("هل مستوى PH مناسب لمحصول البندورة؟", "combined"),
    ("هل بيانات المستشعر تشير إلى حاجة القمح للري؟", "combined"),
    ("هل الرطوبة الحالية كافية لمحصول البطاطا؟", "combined"),
    ("هل أحتاج ري الفول اليوم حسب بيانات الحساس؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذره؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول البندورة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الطماطم؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول البطاطا؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول القمح؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الفول؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول البصل؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الخيار؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الفلفل؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الباذنجان؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الكوسا؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الجزر؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الفراولة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول البطيخ؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الشمام؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول التفاح؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول العنب؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الزيتون؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول البرتقال؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الليمون؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول المشمش؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الخوخ؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الكمثرى؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الرمان؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول التين؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الفستق؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول اللوز؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الجوز؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول البندق؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الكرز؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول التوت؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الفستق الحلبي؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الفستق السوداني؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الحمص؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول العدس؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الفاصولياء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول البازلاء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الكتان؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول السمسم؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الشوفان؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الشعير؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الصفراء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة البيضاء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الحلوة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الرفيعة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة السكرية؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية البيضاء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الحمراء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية السوداء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية البنفسجية؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الزرقاء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الخضراء؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية البرتقالية؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الوردية؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية البنية؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الرمادية؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء الفاتحة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء الداكنة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المتوسطة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المخضرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المحمرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المزرقّة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المصفرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المبيضة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسودة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة الداكنة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة الفاتحة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المتوسطة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المخضرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المحمرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المزرقّة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المصفرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المبيضة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسودة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة الداكنة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة الفاتحة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المتوسطة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المخضرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المحمرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المزرقّة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المصفرة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المبيضة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المسودة؟", "combined"),
    ("هل الظروف البيئية مناسبة لمحصول الذرة الشامية الصفراء المسكرة المسكرة المسكرة؟", "combined"),
]

label2id = {"sensor_data": 0, "crop_info": 1, "combined": 2}
texts = [x[0] for x in examples]
labels = [label2id[x[1]] for x in examples]

model_name = "asafaya/bert-mini-arabic"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForSequenceClassification.from_pretrained(model_name, num_labels=3)

encodings = tokenizer(texts, truncation=True, padding=True, max_length=32)
class IntentDataset(torch.utils.data.Dataset):
    def __init__(self, encodings, labels):
        self.encodings = encodings
        self.labels = labels
    def __getitem__(self, idx):
        item = {key: torch.tensor(val[idx]) for key, val in self.encodings.items()}
        item['labels'] = torch.tensor(self.labels[idx])
        return item
    def __len__(self):
        return len(self.labels)

dataset = IntentDataset(encodings, labels)

training_args = TrainingArguments(
    output_dir='./arabert-intent',
    num_train_epochs=10,
    per_device_train_batch_size=2,
    logging_steps=5,
    save_steps=10,
    learning_rate=2e-5,
    seed=42,
    disable_tqdm=False,
)

trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=dataset,
)

trainer.train()
model.save_pretrained("./arabert-intent")
tokenizer.save_pretrained("./arabert-intent")
print("تم حفظ النموذج في مجلد arabert-intent") 